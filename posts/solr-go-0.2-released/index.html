<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Solr-Go 0.2 released! - stevenferrer.github.io</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta property="og:title" content="Solr-Go 0.2 released!" />
<meta property="og:description" content="A new and improved API for interacting with Solr in Go" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://stevenferrer.github.io/posts/solr-go-0.2-released/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-02-10T02:12:31&#43;00:00" />
<meta property="article:modified_time" content="2021-02-10T02:12:31&#43;00:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Solr-Go 0.2 released!"/>
<meta name="twitter:description" content="A new and improved API for interacting with Solr in Go"/>
<link href="https://fonts.googleapis.com/css?family=Ubuntu:300,400,300italic,400italic|Raleway:200,300" rel="stylesheet">

	<link rel="stylesheet" type="text/css" media="screen" href="https://stevenferrer.github.io/css/normalize.css" />
	<link rel="stylesheet" type="text/css" media="screen" href="https://stevenferrer.github.io/css/main.css" /><link rel="stylesheet" type="text/css" href="https://stevenferrer.github.io/css/dark.css" media="(prefers-color-scheme: dark)" />

	<script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
	<script src="https://stevenferrer.github.io/js/main.js"></script>
</head>

<body>
	<div class="container wrapper post">
		<div class="header">
	<h1 class="site-title"><a href="https://stevenferrer.github.io/">stevenferrer.github.io</a></h1>
	<div class="site-description"><h2>To define is to limit. - Oscar Wilde</h2><nav class="nav social">
			<ul class="flat"><a href="https://github.com/stevenferrer" title="Github"><i data-feather="github"></i></a><a href="https://www.linkedin.com/in/stevenferrer" title="Linkedin"><i data-feather="linkedin"></i></a></ul>
		</nav>
	</div>

	<nav class="nav">
		<ul class="flat">
			
			<li>
				<a href="/">home</a>
			</li>
			
			<li>
				<a href="/posts">all posts</a>
			</li>
			
			<li>
				<a href="/tags">tags</a>
			</li>
			
			<li>
				<a href="/about">about me</a>
			</li>
			
		</ul>
	</nav>
</div>


		<div class="post-header">
			<h1 class="title">Solr-Go 0.2 released!</h1>
			<div class="meta">Posted at &mdash; Feb 10, 2021</div>
		</div>

		<div class="markdown">
			<h2 id="contents">Contents</h2>
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#whats-new">What&rsquo;s new?</a>
<ul>
<li><a href="#other-changes">Other changes</a></li>
</ul>
</li>
<li><a href="#thanks">Thanks!</a></li>
</ul>
<h2 id="introduction">Introduction</h2>
<p><a href="https://github.com/sf9v/solr-go">Solr-Go</a> started as a rudimentary client for interacting with <a href="https://lucene.apache.org/solr/">Solr</a> in <a href="https://golang.org/">Go</a>. It was built for maximum flexibility, which sacrificed the usability.</p>
<p>It didn&rsquo;t have a convenient way of building requests; And there are separate clients for each Solr API, which means you&rsquo;ll need two clients if you want to interact with the <a href="https://lucene.apache.org/solr/guide/8_8/searching.html">Query</a> and <a href="https://lucene.apache.org/solr/guide/8_8/documents-fields-and-schema-design.html">Schema API</a>.</p>
<p>Below is an example of querying in version <code>0.1.x</code>.</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#719e07">import</span> (
    <span style="color:#2aa198">&#34;context&#34;</span>

    solrquery <span style="color:#2aa198">&#34;github.com/sf9v/solr-go/query&#34;</span>
)

<span style="color:#719e07">...</span> 
<span style="color:#586e75">// Create a client
</span><span style="color:#586e75"></span>queryClient <span style="color:#719e07">:=</span> solrquery.<span style="color:#268bd2">NewClient</span>(<span style="color:#2aa198">&#34;localhost&#34;</span>, <span style="color:#2aa198">8983</span>)

<span style="color:#586e75">// Build the query manually using map of interfaces
</span><span style="color:#586e75"></span>query <span style="color:#719e07">:=</span> <span style="color:#268bd2">map</span>[<span style="color:#dc322f">string</span>]<span style="color:#268bd2">interface</span>{}{
    <span style="color:#2aa198">&#34;query&#34;</span>: <span style="color:#2aa198">&#34;{!lucene df=name v=iPod}&#34;</span>,
}

ctx <span style="color:#719e07">:=</span> context.<span style="color:#268bd2">Background</span>()
collection <span style="color:#719e07">:=</span> <span style="color:#2aa198">&#34;techproducts&#34;</span>

<span style="color:#586e75">// send the query
</span><span style="color:#586e75"></span>queryResp, err <span style="color:#719e07">:=</span> queryClient.<span style="color:#268bd2">Query</span>(ctx, collection, query)
<span style="color:#719e07">...</span>
</code></pre></div><p>As we can see from the example above, the query is built manually. Building queries manually can be very tedious and error-prone.</p>
<h2 id="whats-new">What&rsquo;s new?</h2>
<p>In this release, we tried to improve the overall usability of the library by leveraging the <a href="https://en.wikipedia.org/wiki/Builder_pattern">builder pattern</a> which resulted in a more convenient API.</p>
<p>It is now very easy to build complex queries. An additional improvement is that, we only have a single client, which means you only need one client to interact with all Solr APIs (query, update, collections, config, etc.).</p>
<p>Below is an example of querying in version <code>0.2</code>.</p>
<div class="highlight"><pre style="color:#93a1a1;background-color:#002b36;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#719e07">import</span> (
    <span style="color:#2aa198">&#34;github.com/sf9v/solr-go&#34;</span>
)

<span style="color:#719e07">...</span>

<span style="color:#586e75">// Create a client
</span><span style="color:#586e75"></span>baseURL <span style="color:#719e07">:=</span> <span style="color:#2aa198">&#34;http://solr.example.com&#34;</span>
collection <span style="color:#719e07">:=</span> <span style="color:#2aa198">&#34;techproducts&#34;</span>
ctx <span style="color:#719e07">:=</span> context.<span style="color:#268bd2">Background</span>()
client <span style="color:#719e07">:=</span> solr.<span style="color:#268bd2">NewJSONClient</span>(baseURL)

<span style="color:#586e75">// Create a query
</span><span style="color:#586e75"></span>query <span style="color:#719e07">:=</span> solr.<span style="color:#268bd2">NewQuery</span>().
    <span style="color:#268bd2">QueryParser</span>(
        <span style="color:#586e75">// dismax query parser
</span><span style="color:#586e75"></span>        solr.<span style="color:#268bd2">NewDisMaxQueryParser</span>().
            <span style="color:#268bd2">Query</span>(<span style="color:#2aa198">&#34;&#39;solr rocks&#39;&#34;</span>),
    ).
    <span style="color:#268bd2">Queries</span>(solr.M{
        <span style="color:#2aa198">&#34;query_filters&#34;</span>: []solr.M{
            {
                <span style="color:#2aa198">&#34;#size_tag&#34;</span>: solr.M{
                    <span style="color:#2aa198">&#34;field&#34;</span>: solr.M{
                        <span style="color:#2aa198">&#34;f&#34;</span>:     <span style="color:#2aa198">&#34;size&#34;</span>,
                        <span style="color:#2aa198">&#34;query&#34;</span>: <span style="color:#2aa198">&#34;XL&#34;</span>,
                    },
                },
            },
            {
                <span style="color:#2aa198">&#34;#color_tag&#34;</span>: solr.M{
                    <span style="color:#2aa198">&#34;field&#34;</span>: solr.M{
                        <span style="color:#2aa198">&#34;f&#34;</span>:     <span style="color:#2aa198">&#34;color&#34;</span>,
                        <span style="color:#2aa198">&#34;query&#34;</span>: <span style="color:#2aa198">&#34;Red&#34;</span>,
                    },
                },
            },
        },
    }).
    <span style="color:#268bd2">Facets</span>(
        <span style="color:#586e75">// facets
</span><span style="color:#586e75"></span>        solr.<span style="color:#268bd2">NewTermsFacet</span>(<span style="color:#2aa198">&#34;categories&#34;</span>).
            <span style="color:#268bd2">Field</span>(<span style="color:#2aa198">&#34;cat&#34;</span>).<span style="color:#268bd2">Limit</span>(<span style="color:#2aa198">10</span>),
        solr.<span style="color:#268bd2">NewQueryFacet</span>(<span style="color:#2aa198">&#34;high_popularity&#34;</span>).
            <span style="color:#268bd2">Query</span>(<span style="color:#2aa198">&#34;popularity:[8 TO 10]&#34;</span>),
    ).
    <span style="color:#268bd2">Sort</span>(<span style="color:#2aa198">&#34;score&#34;</span>).
    <span style="color:#268bd2">Offset</span>(<span style="color:#2aa198">1</span>).
    <span style="color:#268bd2">Limit</span>(<span style="color:#2aa198">10</span>).
    <span style="color:#268bd2">Filters</span>(<span style="color:#2aa198">&#34;inStock:true&#34;</span>).
    <span style="color:#268bd2">Fields</span>(<span style="color:#2aa198">&#34;name&#34;</span>, <span style="color:#2aa198">&#34;price&#34;</span>)

<span style="color:#586e75">// Send the query
</span><span style="color:#586e75"></span>queryResponse, err <span style="color:#719e07">:=</span> client.<span style="color:#268bd2">Query</span>(ctx, collection, query)
<span style="color:#719e07">...</span>
</code></pre></div><h3 id="other-changes">Other changes</h3>
<ul>
<li>Added support for <a href="https://lucene.apache.org/solr/guide/8_8/collections-api.html">Collections API</a></li>
<li>Improved support for <a href="https://lucene.apache.org/solr/guide/8_8/json-facet-api.html">Facet API</a></li>
<li>Improved support for <a href="https://lucene.apache.org/solr/guide/8_8/suggester.html">Suggester API</a></li>
<li>Improved unit and integration tests</li>
</ul>
<h2 id="thanks">Thanks!</h2>
<p>We hoped that you&rsquo;ll find this project useful as much as we did. As always, any suggestions and ideas on how to improve the project is welcome! Please feel free to <a href="https://github.com/sf9v/solr-go/issues">open an issue</a> or <a href="https://github.com/sf9v/solr-go/pulls">make a pull request</a>.</p>

		</div>

		<div class="post-tags">
			
				
					<nav class="nav tags">
							<ul class="flat">
								
								<li><a href="/tags/solr">solr</a></li>
								
								<li><a href="/tags/go">go</a></li>
								
							</ul>
					</nav>
				
			
		</div>
		</div>
	<div class="footer wrapper">
	<nav class="nav">
		<div> © Copyright 2020 |  <a href="https://github.com/vividvilla/ezhil">Ezhil theme</a> | Built with <a href="https://gohugo.io">Hugo</a></div>
	</nav>
</div>



<script>feather.replace()</script>
</body>
</html>
